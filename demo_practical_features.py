#!/usr/bin/env python3
"""
Shadow AI - Feature Demo Script
Demonstrates all the working practical features
"""

import sys
import os
import time
from pathlib import Path

# Add project root to Python path
project_root = Path(__file__).parent
sys.path.insert(0, str(project_root))

def main():
    """Demo all Shadow AI practical features"""
    print("ğŸš€ Shadow AI - Feature Demonstration")
    print("=" * 50)
    print()
    
    try:
        from main import ShadowAI
        shadow_ai = ShadowAI()
        shadow_ai.init_enhanced_features()
        print("âœ… Shadow AI initialized successfully!")
    except Exception as e:
        print(f"âš ï¸ Shadow AI initialization failed: {e}")
        print("ğŸ“ Will demonstrate basic features without full AI integration")
        shadow_ai = None
    
    print()
    print("ğŸ¯ Available Practical Features:")
    print()
    
    features = [
        ("1", "ğŸ“ Open Notepad", demo_open_notepad),
        ("2", "ğŸ“„ Write Article in Notepad", demo_write_article),
        ("3", "ğŸš€ Launch Applications", demo_launch_apps),
        ("4", "âŒ¨ï¸ Type Text Automation", demo_type_text),
        ("5", "ğŸ“ File Operations", demo_file_operations),
        ("6", "ğŸŒ Web Search", demo_web_search),
        ("7", "ğŸ’» System Information", demo_system_info),
        ("8", "ğŸ”” Test All Features", demo_all_features),
        ("0", "âŒ Exit", None)
    ]
    
    for num, desc, _ in features:
        print(f"  {num}. {desc}")
    
    print()
    
    while True:
        try:
            choice = input("Select feature to demo (0-8): ").strip()
            
            if choice == "0":
                print("ğŸ‘‹ Goodbye!")
                break
            
            # Find and execute the selected demo
            for num, desc, func in features:
                if choice == num and func:
                    print(f"\nğŸ¬ Demonstrating: {desc}")
                    print("-" * 40)
                    func(shadow_ai)
                    print("-" * 40)
                    print("âœ… Demo completed!")
                    print()
                    break
            else:
                print("âŒ Invalid selection. Please try again.")
                
        except KeyboardInterrupt:
            print("\nğŸ‘‹ Demo interrupted. Goodbye!")
            break
        except Exception as e:
            print(f"âŒ Error: {e}")

def demo_open_notepad(shadow_ai):
    """Demo opening Notepad"""
    print("ğŸ“ Opening Notepad...")
    
    if shadow_ai:
        try:
            result = shadow_ai.execute_desktop_action('open_notepad', {})
            if result:
                print("âœ… Notepad opened using Shadow AI!")
            else:
                fallback_open_notepad()
        except Exception as e:
            print(f"âš ï¸ Shadow AI method failed: {e}")
            fallback_open_notepad()
    else:
        fallback_open_notepad()

def fallback_open_notepad():
    """Fallback method to open Notepad"""
    try:
        import subprocess
        subprocess.Popen(['notepad.exe'])
        print("âœ… Notepad opened using fallback method!")
    except Exception as e:
        print(f"âŒ Failed to open Notepad: {e}")

def demo_write_article(shadow_ai):
    """Demo writing an article to Notepad"""
    topic = input("ğŸ“ Enter article topic (or press Enter for 'AI'): ").strip()
    if not topic:
        topic = "Artificial Intelligence"
    
    print(f"ğŸ“„ Writing article about '{topic}' to Notepad...")
    
    if shadow_ai:
        try:
            result = shadow_ai.execute_desktop_action('open_notepad_and_write_article', {'topic': topic})
            if result:
                print("âœ… Article written to Notepad using Shadow AI!")
                return
        except Exception as e:
            print(f"âš ï¸ Shadow AI method failed: {e}")
    
    # Fallback method
    print("ğŸ“ Using fallback method...")
    try:
        import subprocess
        import pyautogui
        
        # Open Notepad
        subprocess.Popen(['notepad.exe'])
        time.sleep(2)
        
        # Generate simple article
        article = f"""# Article: {topic.title()}

## Introduction
This article discusses {topic.lower()} and its importance in today's world.

## Key Points
1. {topic.title()} is a rapidly evolving field
2. It has applications across many industries  
3. Understanding {topic.lower()} is becoming essential

## Conclusion
{topic.title()} will continue to shape our future.

---
Generated by Shadow AI Demo
"""
        
        # Type the article
        pyautogui.typewrite(article, interval=0.01)
        print("âœ… Article written using fallback method!")
        
    except Exception as e:
        print(f"âŒ Failed to write article: {e}")

def demo_launch_apps(shadow_ai):
    """Demo launching applications"""
    apps = [
        ("Calculator", "calc.exe"),
        ("Paint", "mspaint.exe"),
        ("File Explorer", "explorer.exe"),
        ("Notepad", "notepad.exe")
    ]
    
    print("ğŸš€ Available applications to launch:")
    for i, (name, _) in enumerate(apps, 1):
        print(f"  {i}. {name}")
    
    try:
        choice = int(input("Select app (1-4): ")) - 1
        if 0 <= choice < len(apps):
            name, command = apps[choice]
            print(f"ğŸš€ Launching {name}...")
            
            try:
                import subprocess
                subprocess.Popen([command])
                print(f"âœ… {name} launched successfully!")
            except Exception as e:
                print(f"âŒ Failed to launch {name}: {e}")
        else:
            print("âŒ Invalid selection")
    except ValueError:
        print("âŒ Please enter a valid number")

def demo_type_text(shadow_ai):
    """Demo typing text automation"""
    text = input("âŒ¨ï¸ Enter text to type (will type after 3 seconds): ").strip()
    if not text:
        text = "Hello from Shadow AI! This text was typed automatically."
    
    print("â° You have 3 seconds to click in any text field...")
    for i in range(3, 0, -1):
        print(f"   {i}...")
        time.sleep(1)
    
    print("âŒ¨ï¸ Typing text now...")
    
    try:
        import pyautogui
        pyautogui.typewrite(text, interval=0.05)
        print("âœ… Text typed successfully!")
    except Exception as e:
        print(f"âŒ Failed to type text: {e}")

def demo_file_operations(shadow_ai):
    """Demo file operations"""
    print("ğŸ“ File Operations Demo:")
    print("  1. Show current directory contents")
    print("  2. Create a test file")
    print("  3. Show file organization features")
    
    try:
        choice = input("Select operation (1-3): ").strip()
        
        if choice == "1":
            print("ğŸ“‚ Current directory contents:")
            try:
                import os
                files = os.listdir('.')
                for i, file in enumerate(files[:10], 1):  # Show first 10 files
                    print(f"  {i:2d}. {file}")
                if len(files) > 10:
                    print(f"     ... and {len(files) - 10} more files")
                print("âœ… Directory listing completed!")
            except Exception as e:
                print(f"âŒ Error listing directory: {e}")
        
        elif choice == "2":
            print("ğŸ“„ Creating test file...")
            try:
                with open("shadow_ai_test.txt", "w") as f:
                    f.write("This is a test file created by Shadow AI!\n")
                    f.write(f"Created on: {time.strftime('%Y-%m-%d %H:%M:%S')}\n")
                print("âœ… Test file 'shadow_ai_test.txt' created!")
            except Exception as e:
                print(f"âŒ Error creating file: {e}")
        
        elif choice == "3":
            print("ğŸ—‚ï¸ File organization features available:")
            print("  â€¢ Organize files by type (images, documents, etc.)")
            print("  â€¢ Clean up duplicate files")
            print("  â€¢ Create backup folders")
            print("  â€¢ Find large files")
            if shadow_ai:
                print("  âœ… All features available through Shadow AI!")
            else:
                print("  âš ï¸ Full features require Shadow AI initialization")
        
    except Exception as e:
        print(f"âŒ Error in file operations: {e}")

def demo_web_search(shadow_ai):
    """Demo web search functionality"""
    query = input("ğŸŒ Enter search query: ").strip()
    if not query:
        query = "Shadow AI automation"
    
    print(f"ğŸ” Searching for: '{query}'")
    
    if shadow_ai:
        try:
            result = shadow_ai.handle_web_search(f"search Google for {query}")
            if result:
                print("âœ… Web search executed using Shadow AI!")
                return
        except Exception as e:
            print(f"âš ï¸ Shadow AI search failed: {e}")
    
    # Fallback - open browser with search
    print("ğŸŒ Opening browser search...")
    try:
        import webbrowser
        search_url = f"https://www.google.com/search?q={query.replace(' ', '+')}"
        webbrowser.open(search_url)
        print("âœ… Browser opened with search results!")
    except Exception as e:
        print(f"âŒ Failed to open browser: {e}")

def demo_system_info(shadow_ai):
    """Demo system information"""
    print("ğŸ’» Gathering system information...")
    
    if shadow_ai:
        try:
            result = shadow_ai.handle_system_info("show system information")
            if result:
                print("âœ… System info displayed using Shadow AI!")
                return
        except Exception as e:
            print(f"âš ï¸ Shadow AI system info failed: {e}")
    
    # Fallback system info
    print("ğŸ“Š Basic system information:")
    try:
        import platform
        import psutil
        
        print(f"  ğŸ–¥ï¸ System: {platform.system()} {platform.release()}")
        print(f"  ğŸ Python: {platform.python_version()}")
        print(f"  ğŸ’» CPU: {psutil.cpu_count()} cores")
        print(f"  ğŸ§  Memory: {psutil.virtual_memory().total // (1024**3)} GB")
        print(f"  ğŸ“ˆ CPU Usage: {psutil.cpu_percent(interval=1):.1f}%")
        print(f"  ğŸ§  Memory Usage: {psutil.virtual_memory().percent:.1f}%")
        print("âœ… System information displayed!")
        
    except ImportError:
        print("âš ï¸ psutil not available for detailed system info")
        print(f"  ğŸ–¥ï¸ System: {platform.system()} {platform.release()}")
        print(f"  ğŸ Python: {platform.python_version()}")
    except Exception as e:
        print(f"âŒ Error getting system info: {e}")

def demo_all_features(shadow_ai):
    """Demo all features quickly"""
    print("ğŸ”¥ Testing all features quickly...")
    print()
    
    features = [
        ("ğŸ“ Notepad", lambda: demo_open_notepad(shadow_ai)),
        ("ğŸ’» System Info", lambda: demo_system_info(shadow_ai)),
        ("ğŸ“ File Ops", lambda: demo_file_operations(shadow_ai))
    ]
    
    for name, func in features:
        print(f"ğŸ¬ Testing {name}...")
        try:
            func()
            time.sleep(1)
        except Exception as e:
            print(f"âŒ {name} failed: {e}")
        print()
    
    print("ğŸ‰ All features tested!")

if __name__ == "__main__":
    main()
